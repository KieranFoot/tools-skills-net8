Chapter 5 199 reader.GetString(2)); EmployeesListBox.Items.Add(employee); } reader.Close(); connection.Close(); } catch (Exception ex) { MessageBox.Show(ex.Message); } } EmployeesListBox.Items.Add( $"Sync: {timer.ElapsedMilliseconds:N0}ms"); } private async void GetEmployeesAsyncButton_Click( object sender, RoutedEventArgs e) { Stopwatch timer = Stopwatch.StartNew(); using (SqlConnection connection = new(connectionString)) { try { await connection.OpenAsync(); SqlCommand command = new(sql, connection); SqlDataReader reader = await command.ExecuteReaderAsync(); while (await reader.ReadAsync()) { string employee = string.Format("{0}: {1} {2}", await reader.GetFieldValueAsync<int>(0), await reader.GetFieldValueAsync<string>(1), await reader.GetFieldValueAsync<string>(2)); EmployeesListBox.Items.Add(employee); } await reader.CloseAsync(); 