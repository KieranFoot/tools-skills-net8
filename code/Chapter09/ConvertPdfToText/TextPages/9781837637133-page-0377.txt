Building and Securing Web Services Using Minimal APIs 344 if (string.IsNullOrEmpty(clientName)) { clientName = $"console-client-{Guid.NewGuid()}"; } WriteLine($"X-Client-Id will be: {clientName}"); HttpClient client = new(); client.BaseAddress = new("https://localhost:5081"); client.DefaultRequestHeaders.Accept.Add(new("application/json")); // Specify the rate limiting client id for this console app. client.DefaultRequestHeaders.Add("X-Client-Id", clientName); while (true) { WriteInColor(string.Format("{0:hh:mm:ss}: ", DateTime.UtcNow), ConsoleColor.DarkGreen); int waitFor = 1; // Second. try { HttpResponseMessage response = await client.GetAsync("api/products"); if (response.IsSuccessStatusCode) { Product[]? products = await response.Content.ReadFromJsonAsync<Product[]>(); if (products != null) { foreach (Product product in products) { Write(product.ProductName); Write(", "); } WriteLine(); 