Building Serverless Nanoservices Using Azure Functions 466 try { if (Environment.GetEnvironmentVariable("IS_LOCAL") == "true") { // Create blob in the local filesystem. string folder = $@"{System.Environment.CurrentDirectory}\ blobs"; if (!Directory.Exists(folder)) { Directory.CreateDirectory(folder); } log.LogInformation($"Blobs folder: {folder}"); string blobPath = $@"{folder}\{blobName}"; image.SaveAsPng(blobPath); } // Create BLOB in Blob Storage via a memory stream. MemoryStream stream = new(); image.SaveAsPng(stream); stream.Seek(0, SeekOrigin.Begin); return stream.ToArray(); } catch (System.Exception ex) { log.LogError(ex.Message); } return Array.Empty<byte>(); } } } Note the following: â€¢ The [QueueTrigger("checksQueue")] string message parameter means the function is triggered by a message being added to the checksQueue and the queued item is automatically passed to the parameter named message. 