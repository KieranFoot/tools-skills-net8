Chapter 8 355 private static List<Product> GetProducts(decimal? minimumUnitPrice = null) { SqlConnectionStringBuilder builder = new(); builder.InitialCatalog = "Northwind"; builder.MultipleActiveResultSets = true; builder.Encrypt = true; builder.TrustServerCertificate = true; builder.ConnectTimeout = 10; // Default is 30 seconds. builder.DataSource = "."; // Local SQL Server builder.IntegratedSecurity = true; /* // To use SQL Server Authentication: builder.UserID = Environment.GetEnvironmentVariable("MY_SQL_USR"); builder.Password = Environment.GetEnvironmentVariable("MY_SQL_PWD"); builder.PersistSecurityInfo = false; */ SqlConnection connection = new(builder.ConnectionString); connection.Open(); SqlCommand cmd = connection.CreateCommand(); cmd.CommandType = CommandType.Text; cmd.CommandText = "SELECT ProductId, ProductName, UnitPrice FROM Products"; if (minimumUnitPrice.HasValue) { cmd.CommandText += " WHERE UnitPrice >= @minimumUnitPrice"; cmd.Parameters.AddWithValue("minimumUnitPrice", minimumUnitPrice); } SqlDataReader r = cmd.ExecuteReader(); List<Product> products = new(); 