Chapter 9 481 xml = XmlWriter.Create(xmlFileStream, new XmlWriterSettings { Indent = true }); // Write the XML declaration. xml.WriteStartDocument(); // Write a root element. xml.WriteStartElement("callsigns"); // Enumerate the strings, writing each one to the stream. foreach (string item in Viper.Callsigns) { xml.WriteElementString("callsign", item); } // Write the close root element. xml.WriteEndElement(); } catch (Exception ex) { // If the path doesn't exist the exception will be caught. WriteLine($"{ex.GetType()} says {ex.Message}"); } finally { if (xml is not null) { xml.Close(); WriteLine("The XML writer's unmanaged resources have been disposed."); } if (xmlFileStream is not null) { xmlFileStream.Close(); WriteLine("The file stream's unmanaged resources have been disposed."); } } OutputFileInfo(xmlFile); 