Chapter 2 55 SqlConnectionStringBuilder Clear, Build a valid con- InitialCatalog, nection string for a ContainsKey, DataSource, SQL Server data- Remove Encrypt, UserID, base. Password, After setting all the relevant individual ConnectTimeout, properties, get the and so on ConnectionString property. SqlCommand Connection, Configure the com- ExecuteReader, mand to execute. CommandType, ExecuteNonQuery, CommandText, ExecuteXmlReader, Parameters, CreateParameter Transaction SqlParameter Configure a param- ParameterName, eter for a command. Value, DbType, SqlValue, SqlDbType, Direction, IsNullable SqlDataReader FieldCount, Read, Close, Process the result set from executing HasRows, GetOrdinal, a query. IsClosed, GetInt32, RecordsAffected GetString, GetDecimal, GetFieldValue<T> Table 2.6: Important types in ADO.NET SqlClient SqlConnection has two useful events: StateChange and InfoMessage. All the ExecuteXxx methods of SqlCommand will execute any command. The one you use depends on what you expect to get back: • If the command includes at least one SELECT statement that returns a result set, then call ExecuteReader to execute the command. This method returns a DbDataReader-derived object for reading row-by-row through the result set. If the command does not include at least one SELECT statement, then it is more efficient to call • ExecuteNonQuery. This method returns an integer for the number of rows affected. 