Chapter 13 687 #endregion #region Configure the HTTP pipeline and routes if (!app.Environment.IsDevelopment()) { app.UseHsts(); } app.UseHttpsRedirection(); app.UseDefaultFiles(); // index.html, default.html, and so on. app.UseStaticFiles(); app.MapRazorPages(); app.MapGet("/", () => $"Environment is {app.Environment.EnvironmentName}"); #endregion // Start the web server, host the website, and wait for requests. app.Run(); // This is a thread-blocking call. WriteLine("This executes after the web server has stopped!"); The web application builder registers services that can then be retrieved when the functionality they provide is needed using dependency injection. The naming convention for a method that reg- isters a service is AddService where Service is the service name, for example, AddRazorPages or AddNorthwindContext. Our code registers two services: Razor Pages and an EF Core database context. Common methods that register dependency services, including services that combine other method calls that register services, are shown in Table 13.2: Method Services that it registers Minimum set of services necessary to route requests and invoke AddMvcCore controllers. Most websites will need more configuration than this. AddAuthorization Authentication and authorization services. AddDataAnnotations MVC data annotations service. AddCacheTagHelper MVC cache tag helper service. 